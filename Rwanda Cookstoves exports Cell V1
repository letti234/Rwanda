
//Open MODIS data and clip to geometry
var studyRegion = ee.FeatureCollection("FAO/GAUL/2015/level0")
.filter(ee.Filter.eq("ADM0_NAME", "Rwanda"));

var data = ee.ImageCollection('MODIS/006/MOD44B')
.map(function(image){return image.clip(studyRegion)});

print(data, "MODIS image clipped to Rwanda");

//Open cell data
var ADM = ee.FeatureCollection("users/salem043/Rwanda/Cell_LL");

Map.centerObject(ADM, 8);
Map.addLayer(ADM);

//////////////////////////////////////////////////////////////////////////
//
//Forest cover
//
//////////////////////////////////////////////////////////////////////////

//2000
var forest = data.filter(ee.Filter.date('2000-01-01', '2000-12-31'))
.select("Percent_Tree_Cover").toBands();


forest= forest.select(['2000_03_05_Percent_Tree_Cover'])
  .rename(['for_2000']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean',
    geometry: feature.geometry(),
    scale: 250,
    maxPixels: 1e9
  }));
});




//2001
var forest = data.filter(ee.Filter.date('2001-01-01', '2001-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2001_03_06_Percent_Tree_Cover'])
  .rename(['for_2001']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});



//2002
var forest = data.filter(ee.Filter.date('2002-01-01', '2002-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2002_03_06_Percent_Tree_Cover'])
  .rename(['for_2002']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2003
var forest = data.filter(ee.Filter.date('2003-01-01', '2003-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2003_03_06_Percent_Tree_Cover'])
  .rename(['for_2003']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2004
var forest = data.filter(ee.Filter.date('2004-01-01', '2004-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2004_03_05_Percent_Tree_Cover'])
  .rename(['for_2004']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2005
var forest = data.filter(ee.Filter.date('2005-01-01', '2005-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2005_03_06_Percent_Tree_Cover'])
  .rename(['for_2005']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2006
var forest = data.filter(ee.Filter.date('2006-01-01', '2006-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2006_03_06_Percent_Tree_Cover'])
  .rename(['for_2006']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2007
var forest = data.filter(ee.Filter.date('2007-01-01', '2007-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2007_03_06_Percent_Tree_Cover'])
  .rename(['for_2007']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2008
var forest = data.filter(ee.Filter.date('2008-01-01', '2008-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2008_03_05_Percent_Tree_Cover'])
  .rename(['for_2008']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2009
var forest = data.filter(ee.Filter.date('2009-01-01', '2009-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2009_03_06_Percent_Tree_Cover'])
  .rename(['for_2009']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2010
var forest = data.filter(ee.Filter.date('2010-01-01', '2010-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2010_03_06_Percent_Tree_Cover'])
  .rename(['for_2010']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2011
var forest = data.filter(ee.Filter.date('2011-01-01', '2011-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2011_03_06_Percent_Tree_Cover'])
  .rename(['for_2011']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2012
var forest = data.filter(ee.Filter.date('2012-01-01', '2012-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2012_03_05_Percent_Tree_Cover'])
  .rename(['for_2012']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2013
var forest = data.filter(ee.Filter.date('2013-01-01', '2013-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2013_03_06_Percent_Tree_Cover'])
  .rename(['for_2013']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2014
var forest = data.filter(ee.Filter.date('2014-01-01', '2014-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2014_03_06_Percent_Tree_Cover'])
  .rename(['for_2014']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2015
var forest = data.filter(ee.Filter.date('2015-01-01', '2015-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2015_03_06_Percent_Tree_Cover'])
  .rename(['for_2015']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2016
var forest = data.filter(ee.Filter.date('2016-01-01', '2016-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2016_03_05_Percent_Tree_Cover'])
  .rename(['for_2016']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2017
var forest = data.filter(ee.Filter.date('2017-01-01', '2017-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2017_03_06_Percent_Tree_Cover'])
  .rename(['for_2017']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2018
var forest = data.filter(ee.Filter.date('2018-01-01', '2018-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2018_03_06_Percent_Tree_Cover'])
  .rename(['for_2018']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2019
var forest = data.filter(ee.Filter.date('2019-01-01', '2019-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2019_03_06_Percent_Tree_Cover'])
  .rename(['for_2019']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2020
var forest = data.filter(ee.Filter.date('2020-01-01', '2020-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2020_03_05_Percent_Tree_Cover'])
  .rename(['for_2020']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

Export.table.toDrive(ADM, "forest_cell", "Cookstove_exports");

