
//Open MODIS data and clip to geometry
var studyRegion = ee.FeatureCollection("FAO/GAUL/2015/level0")
.filter(ee.Filter.eq("ADM0_NAME", "Rwanda"));

var data = ee.ImageCollection('MODIS/006/MOD44B')
.map(function(image){return image.clip(studyRegion)});

print(data, "MODIS image clipped to Rwanda");

//Open cell data
var ADM = ee.FeatureCollection("users/salem043/Rwanda/Cell_LL");

Map.centerObject(ADM, 8);
Map.addLayer(ADM);

//////////////////////////////////////////////////////////////////////////
//
//Forest cover
//
//////////////////////////////////////////////////////////////////////////

//2000
var forest = data.filter(ee.Filter.date('2000-01-01', '2000-12-31'))
.select("Percent_Tree_Cover").toBands();


forest= forest.select(['2000_03_05_Percent_Tree_Cover'])
  .rename(['for_2000']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean',
    geometry: feature.geometry(),
    scale: 250,
    maxPixels: 1e9
  }));
});




//2001
var forest = data.filter(ee.Filter.date('2001-01-01', '2001-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2001_03_06_Percent_Tree_Cover'])
  .rename(['for_2001']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});



//2002
var forest = data.filter(ee.Filter.date('2002-01-01', '2002-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2002_03_06_Percent_Tree_Cover'])
  .rename(['for_2002']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2003
var forest = data.filter(ee.Filter.date('2003-01-01', '2003-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2003_03_06_Percent_Tree_Cover'])
  .rename(['for_2003']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2004
var forest = data.filter(ee.Filter.date('2004-01-01', '2004-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2004_03_05_Percent_Tree_Cover'])
  .rename(['for_2004']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2005
var forest = data.filter(ee.Filter.date('2005-01-01', '2005-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2005_03_06_Percent_Tree_Cover'])
  .rename(['for_2005']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2006
var forest = data.filter(ee.Filter.date('2006-01-01', '2006-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2006_03_06_Percent_Tree_Cover'])
  .rename(['for_2006']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2007
var forest = data.filter(ee.Filter.date('2007-01-01', '2007-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2007_03_06_Percent_Tree_Cover'])
  .rename(['for_2007']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2008
var forest = data.filter(ee.Filter.date('2008-01-01', '2008-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2008_03_05_Percent_Tree_Cover'])
  .rename(['for_2008']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2009
var forest = data.filter(ee.Filter.date('2009-01-01', '2009-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2009_03_06_Percent_Tree_Cover'])
  .rename(['for_2009']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2010
var forest = data.filter(ee.Filter.date('2010-01-01', '2010-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2010_03_06_Percent_Tree_Cover'])
  .rename(['for_2010']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2011
var forest = data.filter(ee.Filter.date('2011-01-01', '2011-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2011_03_06_Percent_Tree_Cover'])
  .rename(['for_2011']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2012
var forest = data.filter(ee.Filter.date('2012-01-01', '2012-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2012_03_05_Percent_Tree_Cover'])
  .rename(['for_2012']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2013
var forest = data.filter(ee.Filter.date('2013-01-01', '2013-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2013_03_06_Percent_Tree_Cover'])
  .rename(['for_2013']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2014
var forest = data.filter(ee.Filter.date('2014-01-01', '2014-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2014_03_06_Percent_Tree_Cover'])
  .rename(['for_2014']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2015
var forest = data.filter(ee.Filter.date('2015-01-01', '2015-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2015_03_06_Percent_Tree_Cover'])
  .rename(['for_2015']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2016
var forest = data.filter(ee.Filter.date('2016-01-01', '2016-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2016_03_05_Percent_Tree_Cover'])
  .rename(['for_2016']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2017
var forest = data.filter(ee.Filter.date('2017-01-01', '2017-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2017_03_06_Percent_Tree_Cover'])
  .rename(['for_2017']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2018
var forest = data.filter(ee.Filter.date('2018-01-01', '2018-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2018_03_06_Percent_Tree_Cover'])
  .rename(['for_2018']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2019
var forest = data.filter(ee.Filter.date('2019-01-01', '2019-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2019_03_06_Percent_Tree_Cover'])
  .rename(['for_2019']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2020
var forest = data.filter(ee.Filter.date('2020-01-01', '2020-12-31'))
.select("Percent_Tree_Cover").toBands();

forest= forest.select(['2020_03_05_Percent_Tree_Cover'])
  .rename(['for_2020']);
  
var ADM = ADM.map(function(feature) {
  return feature.set(forest.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

Export.table.toDrive(ADM, "forest_cell", "Cookstove_exports");


//////////////////////////////////////////////////////////////////////////
//
//Nontree Vegetative cover
//
//////////////////////////////////////////////////////////////////////////

var veg = data.filter(ee.Filter.date('2000-01-01', '2000-12-31'))
.select("Percent_NonTree_Vegetation").toBands();


veg= veg.select(['2000_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2000']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean',
    geometry: feature.geometry(),
    scale: 250,
    maxPixels: 1e9
  }));
});




//2001
var veg = data.filter(ee.Filter.date('2001-01-01', '2001-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2001_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2001']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});



//2002
var veg = data.filter(ee.Filter.date('2002-01-01', '2002-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2002_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2002']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2003
var veg = data.filter(ee.Filter.date('2003-01-01', '2003-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2003_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2003']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2004
var veg = data.filter(ee.Filter.date('2004-01-01', '2004-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2004_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2004']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2005
var veg = data.filter(ee.Filter.date('2005-01-01', '2005-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2005_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2005']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2006
var veg = data.filter(ee.Filter.date('2006-01-01', '2006-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2006_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2006']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2007
var veg = data.filter(ee.Filter.date('2007-01-01', '2007-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2007_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2007']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2008
var veg = data.filter(ee.Filter.date('2008-01-01', '2008-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2008_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2008']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2009
var veg = data.filter(ee.Filter.date('2009-01-01', '2009-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2009_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2009']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2010
var veg = data.filter(ee.Filter.date('2010-01-01', '2010-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2010_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2010']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2011
var veg = data.filter(ee.Filter.date('2011-01-01', '2011-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2011_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2011']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2012
var veg = data.filter(ee.Filter.date('2012-01-01', '2012-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2012_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2012']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2013
var veg = data.filter(ee.Filter.date('2013-01-01', '2013-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2013_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2013']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2014
var veg = data.filter(ee.Filter.date('2014-01-01', '2014-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2014_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2014']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//2015
var veg = data.filter(ee.Filter.date('2015-01-01', '2015-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2015_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2015']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2016
var veg = data.filter(ee.Filter.date('2016-01-01', '2016-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2016_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2016']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2017
var veg = data.filter(ee.Filter.date('2017-01-01', '2017-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2017_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2017']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2018
var veg = data.filter(ee.Filter.date('2018-01-01', '2018-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2018_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2018']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2019
var veg = data.filter(ee.Filter.date('2019-01-01', '2019-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2019_03_06_Percent_NonTree_Vegetation'])
.rename(['veg_2019']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});

//2020
var veg = data.filter(ee.Filter.date('2020-01-01', '2020-12-31'))
.select("Percent_NonTree_Vegetation").toBands();

veg= veg.select(['2020_03_05_Percent_NonTree_Vegetation'])
.rename(['veg_2020']);

var ADM = ADM.map(function(feature) {
  return feature.set(veg.reduceRegion({
    reducer: 'mean', geometry: feature.geometry(), scale: 250,
    maxPixels: 1e9
  }));
});


//////////////////////////////////////////////////////////////////////////
  //
  //NonVegetative Cover
//
  //////////////////////////////////////////////////////////////////////////
  
  var veg = data.filter(ee.Filter.date('2000-01-01', '2000-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  
  veg= veg.select(['2000_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2000']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean',
      geometry: feature.geometry(),
      scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  
  
  //2001
  var veg = data.filter(ee.Filter.date('2001-01-01', '2001-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2001_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2001']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  
  //2002
  var veg = data.filter(ee.Filter.date('2002-01-01', '2002-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2002_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2002']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2003
  var veg = data.filter(ee.Filter.date('2003-01-01', '2003-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2003_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2003']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2004
  var veg = data.filter(ee.Filter.date('2004-01-01', '2004-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2004_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2004']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2005
  var veg = data.filter(ee.Filter.date('2005-01-01', '2005-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2005_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2005']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2006
  var veg = data.filter(ee.Filter.date('2006-01-01', '2006-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2006_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2006']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2007
  var veg = data.filter(ee.Filter.date('2007-01-01', '2007-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2007_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2007']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2008
  var veg = data.filter(ee.Filter.date('2008-01-01', '2008-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2008_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2008']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2009
  var veg = data.filter(ee.Filter.date('2009-01-01', '2009-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2009_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2009']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2010
  var veg = data.filter(ee.Filter.date('2010-01-01', '2010-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2010_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2010']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2011
  var veg = data.filter(ee.Filter.date('2011-01-01', '2011-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2011_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2011']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2012
  var veg = data.filter(ee.Filter.date('2012-01-01', '2012-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2012_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2012']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2013
  var veg = data.filter(ee.Filter.date('2013-01-01', '2013-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2013_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2013']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2014
  var veg = data.filter(ee.Filter.date('2014-01-01', '2014-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2014_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2014']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
  //2015
  var veg = data.filter(ee.Filter.date('2015-01-01', '2015-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2015_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2015']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2016
  var veg = data.filter(ee.Filter.date('2016-01-01', '2016-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2016_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2016']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2017
  var veg = data.filter(ee.Filter.date('2017-01-01', '2017-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2017_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2017']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2018
  var veg = data.filter(ee.Filter.date('2018-01-01', '2018-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2018_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2018']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2019
  var veg = data.filter(ee.Filter.date('2019-01-01', '2019-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2019_03_06_Percent_NonVegetated'])
  .rename(['nonveg_2019']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  //2020
  var veg = data.filter(ee.Filter.date('2020-01-01', '2020-12-31'))
  .select("Percent_NonVegetated").toBands();
  
  veg= veg.select(['2020_03_05_Percent_NonVegetated'])
  .rename(['nonveg_2020']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(veg.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  
//////////////////////////////////////////////////////////////////////////
  //
  //Quality - prop. cells with "bad" quality (2+ bits)
//
  //////////////////////////////////////////////////////////////////////////
  
//Function for bitwise extraction
var bitwiseExtract = function(input, fromBit, toBit) {
  var maskSize = ee.Number(1).add(toBit).subtract(fromBit);
  var mask = ee.Number(1).leftShift(maskSize).subtract(1);
  return input.rightShift(fromBit).bitwiseAnd(mask);
};

///2000
var qual = data.filter(ee.Filter.date('2000-01-01', '2000-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

qualMask= qualMask.select(['2000_03_05_Quality'])
  .rename(['qual_2000']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  

///2001
var qual = data.filter(ee.Filter.date('2001-01-01', '2001-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);


qualMask= qualMask.select(['2001_03_06_Quality'])
  .rename(['qual_2001']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  

///2002
var qual = data.filter(ee.Filter.date('2002-01-01', '2002-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

qualMask= qualMask.select(['2002_03_06_Quality'])
  .rename(['qual_2002']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2003
var qual = data.filter(ee.Filter.date('2003-01-01', '2003-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);


qualMask= qualMask.select(['2003_03_06_Quality'])
  .rename(['qual_2003']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  

///2004
var qual = data.filter(ee.Filter.date('2004-01-01', '2004-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

qualMask= qualMask.select(['2004_03_05_Quality'])
  .rename(['qual_2004']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });


///2005
var qual = data.filter(ee.Filter.date('2005-01-01', '2005-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

qualMask= qualMask.select(['2005_03_06_Quality'])
  .rename(['qual_2005']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2006
var qual = data.filter(ee.Filter.date('2006-01-01', '2006-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

Map.addLayer(qualMask);

qualMask= qualMask.select(['2006_03_06_Quality'])
  .rename(['qual_2006']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2007
var qual = data.filter(ee.Filter.date('2007-01-01', '2007-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

Map.addLayer(qualMask);

qualMask= qualMask.select(['2007_03_06_Quality'])
  .rename(['qual_2007']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2008
var qual = data.filter(ee.Filter.date('2008-01-01', '2008-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

Map.addLayer(qualMask);

qualMask= qualMask.select(['2008_03_05_Quality'])
  .rename(['qual_2008']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2009
var qual = data.filter(ee.Filter.date('2009-01-01', '2009-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

Map.addLayer(qualMask);

qualMask= qualMask.select(['2009_03_06_Quality'])
  .rename(['qual_2009']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
///2010
var qual = data.filter(ee.Filter.date('2010-01-01', '2010-12-31'))
  .select("Quality").toBands();

//Classifies quality as "bad" when bit count >1
var qualMask = bitwiseExtract(qual, 0, 7).lte(1);

Map.addLayer(qualMask);

qualMask= qualMask.select(['2010_03_06_Quality'])
  .rename(['qual_2010']);
  
  var ADM = ADM.map(function(feature) {
    return feature.set(qualMask.reduceRegion({
      reducer: 'mean', geometry: feature.geometry(), scale: 250,
      maxPixels: 1e9
    }));
  });
  
  print(ADM.limit(5));